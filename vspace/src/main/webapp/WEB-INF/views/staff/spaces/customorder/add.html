<html layout:decorate="~{layouts/main_staff}">
	<head>
		<style>
			.addNewCustomOrder {
				background: white;
				padding: 30px 40px;
			}
			.orderName, .orderDescription {
				border: 1px solid;
			}
			.dragDropText {
				margin-bottom: 10px;
			}
			.sortableSpaces {
				max-height: 205px;
				overflow-y: scroll;
			}
			.paraContent {
				cursor: pointer;
				border: 1px solid;
				padding: 15px;
			}
			.paraContent:hover {
				background: #D3D3D3;
				font-weight: bold;
			}
			.para {
				margin: 0;
			}
			.goBackContainer {
				float: right;
			}
			.goBackContainer:hover {
				cursor: pointer;
				font-weight: bold;
			}
		</style>
		<link th:href="@{/resources/multiselect/css/multiselect.css}" type="text/css" rel="stylesheet">		    
		<script th:src="@{/resources/multiselect/js/multiselect.min.js}"></script>
		<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
		
		<script th:inline="javascript">
		var spaceDivs = []
		$(document).ready(function() {
			var vals = []
			
			spaceDivs = document.getElementById('sortableSpaces').children;
			var spaceIds = [];
			let index =0;
			 for(ele of spaceDivs){
				spaceIds.push(spaceDivs[index].children[0].id);
				index++;
			} 
			 spaceDivs=[];
			 spaceDivs = spaceIds;
			 $("#spaceOrder").val(spaceDivs);
			
			$("#sortableSpaces").sortable({
			  	update: function(event,ui) {
			  		spaceDivs = [];
			      	$(this).children().each(function(index,element){
			      		spaceDivs.push(element.children[0].id);
			      	});
			      	$("#spaceOrder").val(spaceDivs);
			  	}
			});
			$("#goBackContainer").click(function() {
				window.location.href = "[(@{'/staff/space/order'})]";
			});
		});
		</script>
	</head>
	<body>
	    <div id="addNewCustomOrder" class="main-content addNewCustomOrder" layout:fragment="content">
	    	<div id="goBackContainer" class="goBackContainer">
		    	<span class="icon-arrow-left" style="font-size: 28px"></span>
		    	<span style="vertical-align: middle;">Go Back</span>
	    	</div>
	        <h2>Add New Custom Order</h2>
	        
	        <form method="POST" th:action="@{|/staff/space/order/customorder/add?${_csrf.parameterName}=${_csrf.token}|}" enctype="multipart/form-data">
	        	<input type="hidden"  th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
		        <div class="form-group row">
		            <label class="col-md-2 col-form-label" for="name">Order Name</label>
		            <input placeholder="Name" class="form-control col-md-6 orderName" type="text" id="name" name="name" />
		        </div>
	            <div class="form-group row">
	                <label class="col-md-2 col-form-label" for="description">Order Description</label>
	                <textarea placeholder="Description" rows="5" class="form-control col-md-6 orderDescription" id="description" name="description"></textarea>
	            </div>
	            <div class="dragDropText">Drag and drop to arrange spaces</div>
	            <input type="hidden" id="spaceOrder" name="spaceOrder" value=""/>
		        <div class="form-group row sortableSpaces" id="sortableSpaces">
					<div th:each="selectedSpace: ${spaces}"  class="main-content">
				    	<div th:draggable="true"  th:id="${selectedSpace.id}" th:attr="data-position=1" class="valueDiv tab row paraContent" >
				             <p class="para">[[${selectedSpace.name}]]</p>
					    </div>
			    	</div>
				</div>
				<div>
					<button id="createOrder" type="submit" class="btn primary-btn">Create Order</button>
				</div>
			</form>		
	    </div>
	</body>
</html>