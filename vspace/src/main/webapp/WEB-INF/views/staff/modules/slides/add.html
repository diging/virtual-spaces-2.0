<html layout:decorate="~{layouts/main_staff}">
<head>
<link th:href="@{/resources/multiselect/css/multiselect.css}"
    type="text/css" rel="stylesheet">
<script th:src="@{/resources/multiselect/js/multiselect.min.js}"></script>

<style type="text/css">
.EasyMDEContainer .CodeMirror-wrap{
    overflow-y: scroll;
    height: 400px;
}

/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}


/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}
</style>


<script>
//# sourceURL=click.js
$(document).ready(function(){
	var vals = []
	var choices = []
		
	$('select[id="type"]').change(function(){
	    if ($(this).val() == "BRANCHING_POINT"){
	    	$('#sequences').show();
	    	$('#selectSequence').multiSelect({		    		
	    		dblClick : true,
	    		afterInit : function(container) {
	    			$("#selectSequence").find("option").each(function() {
	    				vals.push($(this).val());
	    			});
	    			$(".ms-selection ul").find("li").each(function(index) {
	    				$(this).attr('value', vals[index]);
	    			});
	    		},
	    		afterSelect : function(value) {
	    			choices = [];
	    			$('.ms-selection ul li.ms-selected').each(function(index, value) {
	    				choices.push($(this).attr('value'));					
	    			});
	    			$("#choices").val(choices);
	    		},
	    		afterDeselect : function(value, text) {
	    			for (var i=choices.length-1; i>=0; i--) {
	    				if (String(choices[i]) === String(value)) {
	    					choices.splice(i, 1);
	    					break;
	    	    		}
	    			}
	    			$("#choices").val(choices);
	    		}
	        });	    				
	     } else {
	    	 $('#sequences').hide();
	     }        
	});
});

function openForm(evt, label) {
	console.log(label);
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(label).style.display = "block";
  evt.currentTarget.className += " active";
  evt.preventDefault();
}
 


</script>
</head>

<body>
    <div class="main-content" layout:fragment="content">
        <h1>Add new Slide</h1>
        <form th:action="@{'/staff/module/'+${moduleId}+'/slide/add'}"
            method="POST" name="f" class="form-horizontal">
            
            
		    <div>
    <!-- Tab navigation -->
			    <ul class="nav nav-tabs">
			        <li class="nav-item" th:classappend="${exhibitionLanguageStat.index == 0} ? 'active'">
			            <a class="nav-link" data-toggle="tab" th:href="'#tab-' + ${exhibitionLanguage.label}">
			                [[${exhibitionLanguage.label}]]
			            </a>
			        </li>
			        <li class="nav-item" th:each="exhibitionLanguage : ${languageObjectList}" th:unless="${exhibitionLanguageStat.index == 0}">
			            <a class="nav-link" data-toggle="tab" th:href="'#tab-' + ${exhibitionLanguage.label}">
			                [[${exhibitionLanguage.label}]]
			            </a>
			        </li>
			    </ul>

    <!-- Tab content -->
			    <div class="tab-content">
			        <div th:classappend="${exhibitionLanguageStat.index == 0} ? 'tab-pane active' : 'tab-pane'"
			             th:id="'tab-' + ${exhibitionLanguage.label}" th:each="exhibitionLanguage : ${languageObjectList}">
			            <div class="form-group row">
			                <label for="name" class="col-md-2 col-form-label">Slide Name:</label>
			                <input type="hidden" th:value="${exhibitionLanguage.label}"
			                       th:attr="name='names'+[__${exhibitionLanguageStat.index}__]+'.exhibitionLanguage.label'">
			                <input type="text" class="form-control col-md-10" name="name" id="name"
			                       th:field="${slide.names[__${exhibitionLanguageStat.index}__].text}">
			            </div>
			
			            <div class="form-group row">
			                <label for="description" class="col-md-2 col-form-label">Description:</label>
			                <input type="hidden" th:value="${exhibitionLanguage.label}"
			                       th:attr="name='descriptions'+[__${exhibitionLanguageStat.index}__]+'.exhibitionLanguage.label'">
			                <textarea class="form-control col-md-10" rows="5" cols="30" id="description" name="description"
			                          th:field="${slide.descriptions[__${exhibitionLanguageStat.index}__].text}"></textarea>
			            </div>
			        </div>
			    </div>

			    <div class="form-group row">
			        <label for="type" class="col-md-2 col-form-label">Type:</label>
			        <select name="type" id="type" class="form-control-xs target" style="height: 50px; width: 300px;">
			            <option id="slide" selected value="SLIDE" label="Slide">Slide</option>
			            <option id="branchingPoint" value="BRANCHING_POINT" label="BranchingPoint">Branching Point</option>
			        </select>
			    </div>
			
			    <div class="form-group row" id="sequences" style="display: none;">
			        <label for="choices" class="col-md-2 col-form-label">Add Choices:</label>
			        <select multiple="multiple" id="selectSequence" name="selectSequence"
			                class="form-control form-control-sm" style="width: 68px;">
			            <option th:each="sequence: ${sequences}" th:value=${sequence.id} th:id=${sequence.id}>
			                [[${sequence.name}]]
			            </option>
			        </select>
			        <input type="hidden" id="choices" name="choices">
			    </div>
			
			    

            <button type="submit" id="newSlide" class="btn primary-btn">Create Slide</button>
        </form>
    </div>
</body>